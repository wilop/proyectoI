<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tico Rides</title>
    <link rel="stylesheet" href="css/template.css">
    <link href='https://fonts.googleapis.com/css?family=Rock+Salt' rel='stylesheet' type='text/css'>
</head>

<body>
    <div class="container">
        <nav><a class="button" href="login.html ">Login</a></nav>
        <header>
            <div class="">
                <div class="logo">
                    <a href="index.html">
                        <img src="img/logo3.jpg" alt="Welcome to Tico Rides!">
                    </a>
                    <h1>Welcome to TicoRides.com</h1>
                </div>
                <h3>Search for a ride</h3>
                <fieldset class="busqueda">
                    <span>
                        <label for="from">From:</label>
                        <input id="from" type="search" placeholder="Type origin or type %" />
                    </span>
                    <span>
                        <label for="to">To:</label>
                        <input id="to" type="search" placeholder="Type destiny or type %" />
                    </span>
                    <span>
                        <input class="button-light" type="submit" value="Find my Ride!" onclick="findRides()" />
                    </span>

                </fieldset>
            </div>
        </header>
        <div>
            <h3>Results for Rides that matches your criteria</h3>
            <div class="centrar">
                <table id="tabla-rides" class="centrar">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Start</th>
                            <th>End</th>
                            <th>
                            </th>
                        </tr>
                    </thead>
                    <tbody class="hidden">
                        <tr>
                            <td>yluna</td>
                            <td>Barrio Los Angeles</td>
                            <td>Ciudad Quesada</td>
                            <td><a href="#" onclick="viewRide()">View</a> </td>

                        </tr>
                        <tr>
                            <td>rbarboza</td>
                            <td>Ciudad Quesada</td>
                            <td>Los Angeles</td>
                            <td><a href="#" onclick="viewRide()">View</a> </td>

                        </tr>
                        <tr>
                            <td>yluna</td>
                            <td>Ciudad Quesada</td>
                            <td>San Pedro</td>
                            <td><a href="#" onclick="viewRide()">View</a> </td>

                        </tr>
                    </tbody>
                    <thfood>
                    </thfood>
                    <caption>Rides found</caption>
                </table>
            </div>
        </div>
        <div>
            <iframe id="frame" src="/dashboard.html"> </iframe>
            <div id="modal" class="modal loginform">
                <div id="modalContent"></div>
                <div id="modalButton" class="modal-button"></div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function findRides() {
            var from = document.getElementById('from').value;
            var to = document.getElementById('to').value;
            from = from.toLowerCase();
            to = to.toLowerCase();

            var myTab = document.getElementById('tabla-rides');
            var myTr = document.getElementsByTagName('tr');

            for (i = 1; i < myTr.length; i++) {
                var myTd = myTr[i].getElementsByTagName('td');
                from2 = myTd[1].innerText.toLowerCase();
                to2 = myTd[2].innerText.toLowerCase();

                if (from2 == from && to2 == to) {
                    myTr[i].style.display = 'table-row';
                } else if (to == '%' && from2 == from) {
                    myTr[i].style.display = 'table-row';

                } else if (from == '%' && to2 == to) {
                    myTr[i].style.display = 'table-row';

                } else if (from == '%' && to == '%') {
                    myTr[i].style.display = 'table-row';

                } else {
                    myTr[i].style.display = 'none';
                }
            }
        }

        var closebtn;
        var ele, tr;

        function viewRide() {
            ele = document.activeElement;
            tr = ele.parentElement.parentElement;
            var modal = document.getElementById('modal');
            var modalContent = document.getElementById('modalContent');
            var modalButton = document.getElementById('modalButton');
            var frame = document.getElementById('frame');
            closebtn = document.createElement('button');
            closebtn.classList.add('button-light');
            closebtn.innerText = 'Close';
            closebtn.onclick = function (e) {
                modal.style.display = 'none';
                modalContent.innerHTML = "";
                modalButton.innerHTML = "";
            };
            var node = frame.contentWindow.document.getElementById('rides-form');
            modalButton.appendChild(closebtn);
            modalContent.appendChild(document.importNode(node, true));
            var inputs = modalContent.getElementsByTagName('input');
            var textarea = modalContent.getElementsByTagName('textarea')[0];
            textarea.disabled = true;
            for (let i = 0; i < inputs.length; i++) {
                inputs[i].disabled = true;
                if (inputs[i].type == 'reset' || inputs[i].type == 'submit') {
                    inputs[i].style.display = 'none';
                }
            }
            readData();
            modal.style.display = 'grid';

        }

        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
                modalContent.innerHTML = "";
                modalButton.innerHTML = "";
            }
        }

        function readData() {
            if (tr != null) {
                var myTab = document.getElementById('tabla-rides');
                var myTr = myTab.getElementsByTagName('tr');
                // window.alert('tr: ' + tr.innerHTML);
                for (let i = 0; i < myTr.length; i++) {
                    if (myTr[i] == tr) {
                        var myTd = myTr[i].getElementsByTagName('td');
                        // let myTd = myTr[i];
                        // window.alert(myTr[i].innerHTML);
                        // window.alert(myTd[0].innerText);
                        document.getElementById('ridename').value = myTd[0].innerText;
                        document.getElementById('start').value = myTd[1].innerText;
                        document.getElementById('end').value = myTd[2].innerText;
                        // "<td> " +
                        // "<a href='#' onclick='viewRide()'>View</a> - " +
                        // "<a href='#' onclick='editRide()'>Edit</a> - " +
                        // "<a href='#' onclick='deleteRide(document.activeElement)'>Delete</a>" +
                        // "</td>" +
                        // document.getElementById('description').value = myTd[4].innerText;
                        // document.getElementById('departure').value = myTd[5].innerText;
                        // document.getElementById('arrival').value = myTd[6].innerText;
                        // document.getElementById('monday').checked = myTd[7].innerText == 'true' ? true : false;
                        // document.getElementById('tuesday').checked = myTd[8].innerText == 'true' ? true : false;
                        // document.getElementById('wednesday').checked = myTd[9].innerText == 'true' ? true : false;
                        // document.getElementById('thursday').checked = myTd[10].innerText == 'true' ? true : false;
                        // document.getElementById('friday').checked = myTd[11].innerText == 'true' ? true : false;
                        // document.getElementById('saturday').checked = myTd[12].innerText == 'true' ? true : false;
                        // document.getElementById('sunday').checked = myTd[13].innerText == 'true' ? true : false;
                    }
                }
            }
        }

    </script>
</body>

</html>